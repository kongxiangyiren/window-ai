(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function l(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(e){if(e.ep)return;e.ep=!0;const o=l(e);fetch(e.href,o)}})();const V={class:"container ivu-p"},g={class:"dialog"},h={class:"dialog-item-main"},_={class:"question ivu-mt"},w=Vue.defineComponent({__name:"App",setup(p){const n=Vue.ref(""),l=Vue.ref(!1),t=Vue.ref([]),e=Vue.ref(!0),o=Vue.ref(null);Vue.onMounted(async()=>{if(!window.ai){console.log("不支持AI功能, 请在支持AI功能的浏览器中打开,chrome dev 下载：https://www.google.cn/intl/zh-CN/chrome/dev/next-steps.html 详情参考：https://juejin.cn/post/7384997062415843339#heading-2"),t.value.push({id:t.value.length+1,role:"ai",text:"不支持AI功能, 请在支持AI功能的浏览器中打开,chrome dev 下载：https://www.google.cn/intl/zh-CN/chrome/dev/next-steps.html 详情参考：https://juejin.cn/post/7384997062415843339#heading-2"});return}const a=await window.ai.canCreateTextSession();if(a==="readily")console.log("模型已经准备好了"),o.value=window.ai.createTextSession(),e.value=!1;else if(a==="after-download"){console.log("模型正在下载中"),t.value.push({id:t.value.length+1,role:"ai",text:"模型正在下载中"});return}else{console.log("模型还没下载,详情参考：https://juejin.cn/post/7384997062415843339#heading-2"),t.value.push({id:t.value.length+1,role:"ai",text:"模型还没下载,详情参考：https://juejin.cn/post/7384997062415843339#heading-2"});return}});async function i(){if(l.value||n.value==="")return;l.value=!0;const a=n.value;n.value="",t.value.push({id:t.value.length+1,role:"me",text:a});const r=t.value.length+1;t.value.push({id:r,role:"ai",text:"AI 思考中..."});const c=t.value.find(u=>u.id===r);if(!o.value){console.log("session 不存在");return}console.log(t.value,"dialogs.value");const m=(await o.value).promptStreaming(a);c.text="";let d=0;for await(const u of m){const s=u.slice(d);d=u.length,c.text+=s}console.log(c.text),l.value=!1}async function v(){if(t.value=[],!o.value){console.log("session 不存在");return}(await o.value).destroy(),o.value=window.ai.createTextSession()}return(a,r)=>{const c=Vue.resolveComponent("Input"),m=Vue.resolveComponent("Button"),d=Vue.resolveComponent("Col"),u=Vue.resolveComponent("Row");return Vue.openBlock(),Vue.createElementBlock("div",V,[Vue.createElementVNode("div",g,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(t.value,(s,f)=>(Vue.openBlock(),Vue.createElementBlock("div",{key:f,class:Vue.normalizeClass(["dialog-item",{"dialog-item-me":s.role==="me","dialog-item-ai":s.role==="ai"}])},[Vue.createElementVNode("div",h,Vue.toDisplayString(s.text),1)],2))),128))]),Vue.createElementVNode("div",_,[Vue.createVNode(c,{modelValue:n.value,"onUpdate:modelValue":r[0]||(r[0]=s=>n.value=s),type:"textarea",autosize:{minRows:4,maxRows:6},placeholder:"输入你的问题"},null,8,["modelValue"]),Vue.createVNode(u,{class:"ivu-mt"},{default:Vue.withCtx(()=>[Vue.createVNode(d,null,{default:Vue.withCtx(()=>[Vue.createVNode(m,{type:"primary",size:"large",icon:"md-send",disabled:e.value,loading:l.value,onClick:i},{default:Vue.withCtx(()=>[Vue.createTextVNode(" 发送 ")]),_:1},8,["disabled","loading"])]),_:1}),Vue.createVNode(d,null,{default:Vue.withCtx(()=>[Vue.createVNode(m,{size:"large",class:"ivu-ml",icon:"md-add",disabled:l.value||e.value,onClick:v},{default:Vue.withCtx(()=>[Vue.createTextVNode(" 新对话 ")]),_:1},8,["disabled"])]),_:1})]),_:1})])])}}}),x=(p,n)=>{const l=p.__vccOpts||p;for(const[t,e]of n)l[t]=e;return l},y=x(w,[["__scopeId","data-v-1f47dba0"]]);console.log();Vue.createApp(y).use(ViewUIPlus).mount("#app");
